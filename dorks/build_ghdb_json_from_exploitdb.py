import json
from bs4 import BeautifulSoup

# Load your downloaded 'ghdb.json' file from Exploit-DB
with open("ghdb.json", "r", encoding="utf-8") as f:
    raw_data = json.load(f)

# Prepare the categorized dictionary
ghdb = {}

for entry in raw_data["data"]:
    category = entry["category"]["cat_title"]
    html = entry["url_title"]
    # Extract clean text from HTML
    dork = BeautifulSoup(html, "html.parser").get_text()

    if category not in ghdb:
        ghdb[category] = []
    ghdb[category].append(dork)

# Save the final JSON output
with open("ghdb_full.json", "w", encoding="utf-8") as out:
    json.dump(ghdb, out, indent=2, ensure_ascii=False)

print("[+] ghdb_full.json created with", len(ghdb), "categories.")
